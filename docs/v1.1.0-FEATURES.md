# üöÄ Claude Code Router Config v1.1.0 - New Features Guide

Version 1.1.0 brings major enhancements to the Claude Code Router configuration, transforming it from a basic setup package into a comprehensive AI router management system with advanced monitoring, analytics, and extensibility features.

## üìã Table of Contents

- [New Features Overview](#new-features-overview)
- [Advanced CLI Tools](#advanced-cli-tools)
- [Configuration Templates](#configuration-templates)
- [Smart Routing Engine](#smart-routing-engine)
- [Analytics & Monitoring](#analytics--monitoring)
- [Web Dashboard](#web-dashboard)
- [Plugin System](#plugin-system)
- [Enhanced Logging](#enhanced-logging)
- [Migration Guide](#migration-guide)

---

## üéâ New Features Overview

### v1.1.0 Enhancements Summary

| Category | Features | Status |
|----------|----------|--------|
| üõ†Ô∏è **CLI Tools** | Test, benchmark, analytics, health monitoring | ‚úÖ |
| üìã **Templates** | 5 pre-optimized configurations | ‚úÖ |
| üß† **Smart Routing** | Adaptive, cost/performance optimized | ‚úÖ |
| üìä **Analytics** | Usage tracking, cost analysis | ‚úÖ |
| üåê **Web UI** | Interactive dashboard | ‚úÖ |
| üîå **Plugin System** | Extensible architecture | ‚úÖ |
| üìù **Logging** | Enhanced metrics, middleware | ‚úÖ |

---

## üõ†Ô∏è Advanced CLI Tools

### New Commands Added

#### Testing & Diagnostics
```bash
# Test provider connectivity
ccr test openai gpt-4o
ccr test anthropic claude-sonnet-4-latest

# Benchmark all providers
ccr benchmark --all --compare-speed
ccr benchmark full 5 --provider=openai --provider=anthropic

# Load testing
ccr benchmark load openai gpt-4o --concurrent=10 --duration=60
```

#### Analytics & Monitoring
```bash
# View today's statistics
ccr analytics today --detailed
ccr analytics week --detailed
ccr analytics month

# Export analytics data
ccr analytics export --format=csv --period=month
```

#### Configuration Management
```bash
# Apply templates
ccr config template performance-optimized
ccr config template cost-optimized

# Configuration operations
ccr config validate
ccr config backup
```

#### Plugin Management
```bash
# Plugin operations
ccr plugin list
ccr plugin create my-provider --type provider
ccr plugin load custom-provider
ccr plugin unload custom-provider
ccr plugin load-all
```

#### Web Dashboard
```bash
# Open web dashboard (default port 3457)
ccr ui

# Open on custom port
ccr ui --port 8080
```

---

## üìã Configuration Templates

### Available Templates

| Template | Optimization | Best For | Performance | Cost | Quality |
|----------|---------------|----------|------------|------|--------|
| **performance-optimized** | Speed | Real-time apps, chatbots | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | Low | ‚≠ê‚≠ê‚≠ê |
| **cost-optimized** | Cost | Budget-conscious users | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **quality-focused** | Quality | Critical tasks, research | ‚≠ê‚≠ê | Low | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **development** | Coding | Software development | ‚≠ê‚≠ê‚≠ê‚≠ê | Medium | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **balanced** | Balanced | General use | ‚≠ê‚≠ê‚≠ê‚≠ê | Medium | ‚≠ê‚≠ê‚≠ê‚≠ê |

### Template Features

Each template includes:

- **Optimized Provider Priority**: Tailored model selection
- **Routing Strategy**: Specific routing logic
- **Performance Settings**: Timeout, retries, caching
- **Health Monitoring**: Provider health checks
- **Budget Controls**: Cost limits and alerts (cost template)

### Quick Template Switching

```bash
# Apply template and backup current config
ccr config template cost-optimized

# Backup current configuration before switching
ccr config backup
ccr config template quality-focused

# Validate new configuration
ccr config validate
```

---

## üß† Smart Routing Engine

### Core Improvements

#### 1. Adaptive Intelligence
- **Learning System**: Routes improve based on historical performance
- **Context Awareness**: Considers request complexity and timing
- **Cost Awareness**: Respects budget constraints

#### 2. Routing Strategies
- **Cost-Optimized**: Minimizes cost while maintaining quality
- **Performance-Optimized**: Maximizes speed and responsiveness
- **Quality-Optimized**: Prioritizes best results
- **Adaptive**: Balances all factors automatically

#### 3. Advanced Features
- **Auto-Fallback**: Automatic provider switching on failure
- **Load Balancing**: Distributes requests optimally
- **Performance Metrics**: Tracks latency and success rates
- **Route Caching**: Remembers optimal routes for patterns

### Configuration Example

```json
{
  "Router": {
    "default": "openai,gpt-4o",
    "SmartRouting": {
      "enabled": true,
      "strategy": "adaptive",
      "learningPeriod": 7,
      "costOptimization": true
    },
    "Fallback": {
      "enabled": true,
      "maxRetries": 3,
      "circuitBreaker": true
    }
  }
}
```

---

## üìä Analytics & Monitoring

### Metrics Tracked

#### Request Analytics
- Request volume and trends
- Provider and model usage statistics
- Success and error rates
- Average response times

#### Cost Analytics
- Spending per provider and model
- Cost optimization opportunities
- Budget tracking and alerts
- ROI calculations

#### Performance Analytics
- Latency distribution
- Provider performance comparison
- Bottleneck identification
- Load distribution analysis

#### Health Monitoring
- Real-time provider status
- Uptime and availability metrics
- Error pattern analysis
- Automatic failover events

### Analytics Dashboard Features

#### Overview Tab
- System health status
- Today's statistics at a glance
- Provider health indicators
- Quick action buttons

#### Analytics Tab
- Interactive usage charts
- Provider performance graphs
- Cost trend analysis
- Export capabilities

#### Health Tab
- Real-time provider monitoring
- Health check results
- Error rate tracking
- Maintenance recommendations

### Using Analytics

```bash
# View detailed analytics
ccr analytics today --detailed

# Export monthly report
ccr analytics export --format=csv --period=month

# Real-time monitoring (web dashboard)
ccr ui
```

---

## üåê Web Dashboard

### Interactive Features

#### Real-time Monitoring
- Live provider status updates
- Request performance metrics
- System resource usage
- Alert notifications

#### Configuration Management
- Visual configuration editing
- Template application with preview
- Backup and restore operations
- Provider testing interface

#### Analytics Visualization
- Interactive charts and graphs
- Filterable time periods
- Comparison analysis
- Export and sharing options

### Dashboard Architecture

```
Web Dashboard (Port 3457)
‚îú‚îÄ‚îÄ Overview Page     ‚Üí System status, quick stats
‚îú‚îÄ‚îÄ Analytics Page    ‚Üí Usage charts, cost trends
‚îú‚îÄ‚îÄ Health Page      ‚Üí Provider monitoring
‚îú‚îÄ‚îÄ Config Page       ‚Üí Template management
‚îî‚îÄ‚îÄ API Endpoints   ‚Üí Data for CLI tools
```

### Accessing the Dashboard

```bash
# Start dashboard (default port 3457)
ccr ui

# Custom port
ccr ui --port 8080

# Access from browser
http://localhost:3457
```

---

## üîå Plugin System

### Plugin Types

#### 1. Provider Plugins
Add new AI providers with custom logic:

```javascript
class CustomProvider {
  constructor(config) {
    this.apiBase = config.apiBase;
    this.models = config.models;
    this.pricing = config.pricing;
  }

  async createRequest(prompt, options) {
    // Custom request creation logic
  }

  async parseResponse(response) {
    // Custom response parsing
  }
}
```

#### 2. Hook Plugins
Execute code at specific routing points:

```javascript
class LoggingHook {
  get hooks() {
    return {
      'beforeRequest': async (req) => {
        console.log(`Request: ${req.method}`);
      },
      'afterRequest': async (req, response, latency) => {
        console.log(`Completed in ${latency}ms`);
      }
    };
  }
}
```

#### 3. Middleware Plugins
Add custom request/response processing:

```javascript
class RateLimitMiddleware {
  async middleware(req, res, next) {
    // Rate limiting logic
    await next();
  }
}
```

### Plugin Management

#### Create Plugin Scaffold
```bash
# Create provider plugin
ccr plugin create my-provider --type provider

# Create middleware plugin
ccr plugin create rate-limiter --type middleware --description "Rate limiting middleware"
```

#### Plugin Operations
```bash
# List loaded plugins
ccr plugin list

# Load plugin
ccr plugin load my-provider

# Unload plugin
ccr plugin unload my-provider

# Reload plugin (after changes)
ccr plugin reload my-provider

# Load all plugins
ccr plugin load-all
```

### Plugin Structure

```
plugins/my-provider/
‚îú‚îÄ‚îÄ plugin.json          # Plugin configuration
‚îú‚îÄ‚îÄ index.js              # Main plugin file
‚îú‚îÄ‚îÄ package.json          # Dependencies (optional)
‚îî‚îÄ‚îÄ README.md             # Documentation
```

---

## üìù Enhanced Logging System

### Logging Features

#### Structured Logging
- Multiple log levels (fatal, error, warn, info, debug, trace)
- Request/response logging with metrics
- Provider-specific logging
- Error tracking and stack traces

#### Performance Metrics
- Request latency tracking
- Token usage monitoring
- Cost calculation per request
- Success/error rate analysis

#### Middleware Support
- HTTP request/response logging
- API call interceptors
- Route decision logging
- Health check logging

### Log Storage

#### Log Files
```
~/.claude-code-router/logs/
‚îú‚îÄ‚îÄ claude-router-YYYY-MM-DD.log    # Daily logs
‚îú‚îÄ‚îÄ claude-router.1.log             # Rotated logs
‚îú‚îÄ‚îÄ errors.log                   # Error-only log
‚îî‚îÄ‚îÄ metrics.json                 # Aggregated metrics
```

#### Log Configuration
```json
{
  "LOG": true,
  "LOG_LEVEL": "info",
  "LOG_FILE": true,
  "LOG_CONSOLE": true,
  "METRICS_ENABLED": true,
  "ANALYTICS_ENABLED": true
}
```

### Using the Enhanced Logger

```javascript
const { logger } = require('../logging/enhanced-logger');

// Log with metadata
logger.info('Processing request', {
  requestId: 'req_123',
  provider: 'openai',
  model: 'gpt-4o',
  latency: 1500
});

// Log API requests
logger.logRequest('openai', 'gpt-4o', 100, 50, 1500, true, 0.005);
```

---

## üìà Performance Improvements

### Router Performance

#### Smart Selection Algorithm
- Historical performance consideration
- Real-time health status checks
- Adaptive routing based on current conditions
- Predictive routing for known patterns

#### Caching Strategies
- Route decision caching for common patterns
- Response caching where appropriate
- Configuration caching
- Health check result caching

### System Efficiency

#### Resource Management
- Automatic log rotation and cleanup
- Memory-efficient metric storage
- Background health monitoring
- Lazy loading of plugins

#### Monitoring Impact
- Minimal performance overhead
- Asynchronous logging
- Non-blocking health checks
- Optimized data structures

---

## üîß Configuration Enhancements

### New Configuration Options

#### Smart Routing Settings
```json
{
  "SmartRouting": {
    "enabled": true,
    "strategy": "adaptive",
    "learningPeriod": 7,
    "autoOptimize": false
  }
}
```

#### Performance Optimization
```json
{
  "PerformanceOptimization": {
    "enabled": true,
    "timeoutMs": 15000,
    "retryAttempts": 2,
    "preferLowLatency": true
  }
}
```

#### Budget Management
```json
{
  "BudgetManagement": {
    "dailyLimit": 10.0,
    "alerts": true,
    "cheapestFirstFallback": true
  }
}
```

### Environment Variables

#### Plugin System
```bash
export CLAUDE_ROUTER_PLUGINS_DIR="$HOME/.claude-code-router/plugins"
export CLAUDE_ROUTER_AUTOLOAD_PLUGINS=true
```

#### Enhanced Logging
```bash
export CLAUDE_ROUTER_LOG_LEVEL=debug
export CLAUDE_ROUTER_LOG_FILE=true
export CLAUDE_ROUTER_METRICS=true
```

---

## üîÑ Migration Guide

### From v1.0.0 to v1.1.0

#### 1. Update Package
```bash
# Update to latest version
npm update -g claude-code-router-config

# Or install latest
npm install -g claude-code-router-config@latest
```

#### 2. Configuration Update (Optional)
Your existing configuration will continue to work, but you can enhance it:

```bash
# Backup current configuration
ccr config backup

# Apply enhanced smart routing
cp config/smart-intent-router.js ~/.claude-code-router/intent-router.js

# Or use a template
ccr config template balanced
```

#### 3. Enable New Features

```bash
# Enable enhanced logging in config.json
{
  "LOG": true,
  "LOG_LEVEL": "info",
  "ANALYTICS_ENABLED": true,
  "HEALTH_CHECKS": {
    "enabled": true,
    "interval": 30000
  }
}
```

#### 4. Verify Installation

```bash
# Test enhanced features
ccr test openai gpt-4o
ccr analytics today
ccr ui
```

### Backward Compatibility

All v1.0.0 configurations remain fully compatible with v1.1.0. New features use:
- Default settings when not specified
- Graceful fallbacks for missing options
- Automatic migration where safe

---

## üõ†Ô∏è Advanced Usage Examples

### Cost Optimization Workflow
```bash
# Start with cost-optimized template
ccr config template cost-optimized

# Monitor spending
ccr analytics today --detailed

# Analyze spending patterns
ccr analytics export --format=csv --period=month

# Adjust budget if needed
```

### Performance Optimization Workflow
```bash
# Benchmark current setup
ccr benchmark --all --compare-speed

# Apply performance template
ccr config template performance-optimized

# Monitor performance
ccr ui

# Analyze results
ccr analytics week --detailed
```

### Plugin Development Workflow
```bash
# Create custom provider
ccr plugin create my-custom-provider --type provider

# Edit plugin files
cd ~/.claude-code-router/plugins/my-custom-provider

# Test plugin
ccr plugin load my-custom-provider
ccr test my-custom-provider

# Monitor plugin performance
ccr analytics today
```

---

## üîç Troubleshooting

### Common Issues

#### CLI Commands Not Working
```bash
# Check installation
which ccr
ccr --version

# Verify package installation
npm list -g claude-code-router-config
```

#### Dashboard Not Starting
```bash
# Check port availability
lsof -i :3457

# Try different port
ccr ui --port 8080

# Check logs
ccr analytics today
```

#### Plugin Loading Issues
```bash
# Check plugin directory
ls -la ~/.claude-code-router/plugins/

# Check plugin syntax
node -c plugins/my-provider/index.js

# Enable debug logging
export CLAUDE_ROUTER_LOG_LEVEL=debug
ccr plugin load my-provider
```

### Performance Issues

#### Slow Response Times
```bash
# Check provider health
ccr health --all-providers

# Benchmark providers
ccr benchmark --all --compare-speed

# Check analytics for bottlenecks
ccr analytics today --detailed
```

#### High Memory Usage
```bash
# Check system resources
ccr analytics today --detailed

# Clean up old logs
# Logs auto-rotate, but you can force cleanup
rm ~/.claude-code-router/logs/*.log.2
```

---

## üìöÔ∏è Additional Resources

### Documentation
- [Full Documentation (EN)](docs/FULL_DOCUMENTATION_EN.md)
- [Full Documentation (TR)](docs/FULL_DOCUMENTATION.md)
- [Configuration Templates Guide](templates/README.md)
- [Homebrew Setup Guide](docs/HOMEBREW_SETUP.md)
- [AgentSkills Integration](docs/AGENTSKILLS_INTEGRATION.md)

### API Reference
- [CLI Commands Reference](#advanced-cli-tools)
- [Plugin Development Guide](#plugin-system)
- [Configuration Options](#configuration-enhancements)
- [Analytics API](docs/API.md)

### Support
- [GitHub Issues](https://github.com/halilertekin/CC-RouterMultiProvider/issues)
- [Original Router Project](https://github.com/musistudio/claude-code-router)

---

## üéâ What's Next?

### Planned Features for v1.2.0
- üì± Mobile-responsive dashboard
- ü§ñ AI-powered optimization recommendations
- üîó Team collaboration features
- üìä Advanced reporting
- üîÑ Automated plugin updates
- üåê Integration with popular tools

### Contributing
We welcome contributions! See the contributing guidelines in the repository.

### Feedback
Have ideas for improvement? Found a bug? Please open an issue on GitHub.

---

*Last Updated: December 20, 2025*
*Version: 1.1.0*
*Author: Halil Ertekin*